<!doctype html><html lang="pt-BR"><head>
<style>.btn-back{display:inline-block;padding:.55rem .9rem;background:#111827;border:1px solid #334155;border-radius:.6rem;color:#bfdbfe;text-decoration:none;line-height:1}.btn-back:hover{background:#1e293b}</style>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Editar Graduação</title>
<style>
.wrap{max-width:900px;margin:24px auto;padding:0 16px;color:#e5e7eb}
.top{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
.top a{color:#8ecbff;text-decoration:none}
.form{background:#151515;border:1px solid #222;border-radius:10px;padding:16px}
label{display:block;margin-top:10px;color:#9ad1ff}
input{width:100%;padding:10px;border:1px solid #333;background:#202020;color:#eee;border-radius:8px}
button{padding:10px 14px;border:0;border-radius:8px;cursor:pointer;margin-top:14px}
</style>
<style id="graduacao-editar-dark-override">
/* Padroniza no dark global (igual Admin) */
:root{
  --bg-0:#0f1115;
  --bg-1:#0b0e14;
  --stroke:rgba(42,49,64,.75);
  --stroke-strong:rgba(52,152,219,.55);
  --tile:rgba(255,255,255,.05);
  --tile-hover:rgba(255,255,255,.10);
  --text:#e7e9ee;
  --text-dim:rgba(231,233,238,.85);
  --muted:rgba(169,178,195,.85);
  --cta:#3498db;
  --cta-text:#ffffff;
  --content:#0f1115;
  --row:#161a22;
  --row-alt:#131722;
  --row-stroke:#2a3140;
  --card:#161a22;
  --card2:#131722;
  --border:#2a3140;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:radial-gradient(900px 420px at 50% 0%, rgba(52,152,219,.18), transparent 55%), var(--content);
  color:var(--text);
}

/* Botões de voltar */
.btn-back{
  background:linear-gradient(180deg,var(--card),var(--card2)) !important;
  border:1px solid var(--border) !important;
  border-radius:.6rem !important;
  color:var(--cta) !important;
  text-decoration:none;
  line-height:1;
}
.btn-back:hover{
  background:linear-gradient(180deg,var(--card2),var(--card)) !important;
  border-color:rgba(52,152,219,.55) !important;
}

/* Form */
.form{
  background:linear-gradient(180deg,var(--card),var(--card2)) !important;
  border:1px solid var(--border) !important;
  border-radius:10px !important;
  box-shadow:0 10px 28px rgba(0,0,0,.35) !important;
}

/* Labels */
label{
  color:var(--text) !important;
}

/* Inputs */
input{
  background:linear-gradient(180deg,var(--card2),var(--card)) !important;
  border:1px solid var(--border) !important;
  color:var(--text) !important;
  border-radius:8px !important;
}
input:focus{
  border-color:rgba(52,152,219,.55) !important;
  outline:none;
}

/* Botão salvar */
button{
  background:linear-gradient(180deg,var(--cta),#2980b9) !important;
  color:var(--cta-text) !important;
  border:0 !important;
  border-radius:8px !important;
  cursor:pointer;
  margin-top:14px;
}
button:hover{
  background:linear-gradient(180deg,#2980b9,var(--cta)) !important;
}

/* Links */
a{
  color:var(--cta) !important;
  text-decoration:none;
}
a:hover{
  color:#5dade2 !important;
}

/* Títulos */
h2{
  color:var(--text) !important;
}

/* Texto secundário */
#who{
  color:var(--muted) !important;
}
</style>

<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/admin/admin.css"></head><body>
<div class="wrap">
  <div class="top">
    <a class="btn-back" href="/admin/cadastro/lista.html">← <a class="btn-nav" href="/admin/cadastro/lista.html"><span class="chevron">←</span> Voltar à Lista</a></a>
    <a class="btn-back" href="#" id="btn-voltar-anterior"><span class="chevron">←</span> Voltar</a>
  <a class="btn-back btn-nav" href="/admin/"><span class="chevron">←</span> Voltar ao Dashboard</a>
  </div>

  <div class="form">
    <h2 style="color:#9ad1ff">Editar Graduação</h2>
    <div id="who" style="margin:6px 0 12px;color:#ccc"></div>

    <label>Nº Graduação</label>
    <input id="numero">

    <label>Faixa</label>
    <input id="faixa">

    <label>Data</label>
    <input id="data" type="date">

    <button onclick="salvar()">Salvar alterações</button>
  </div>
</div>

<script>
function q(k){ return new URLSearchParams(location.search).get(k); }

async function carregar(){
  const id = q('id');
  if(!id){ alert('ID não informado'); return; }
  const r = await fetch('/api/graduacoes/'+id);
  const js = await r.json();
  if(!js.ok){ alert(js.message || 'Não encontrado'); return; }
  const g = js.data;
  document.getElementById('who').textContent = `Aluno: ${g.aluno_nome || ''} (${g.aluno_email || ''})`;
  document.getElementById('numero').value = g.grad_numero || '';
  document.getElementById('faixa').value  = g.faixa || '';
  document.getElementById('data').value   = g.data_graduacao ? new Date(g.data_graduacao).toISOString().slice(0,10) : '';
}

async function salvar(){
  const id = q('id');
  const payload = {
    grad_numero: (document.getElementById('numero').value || '').trim(),
    faixa: (document.getElementById('faixa').value || '').trim(),
    data_graduacao: document.getElementById('data').value || null,
  };
  const r = await fetch('/api/graduacoes/'+id, {
    method:'PUT',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(payload),
  });
  const js = await r.json();
  if(!js.ok){ alert(js.message || 'Falha ao salvar.'); return; }
  window.location.href = '/admin/graduacao/lista.html';
}

document.addEventListener('DOMContentLoaded', carregar);
</script>
  <script src="/admin/_session_timer.js" defer></script>

<script>
  (function(){
    var btn = document.getElementById("btn-voltar-anterior");
    if(!btn) return;
    btn.addEventListener("click", function(e){
      e.preventDefault();
      if (window.history.length > 1) window.history.back();
      else window.location.href = "/admin/";
    });
  })();
</script>
</body></html>
